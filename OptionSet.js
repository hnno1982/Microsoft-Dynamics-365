/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
var MscrmGeneric;(function(MscrmGeneric){var FieldControls;(function(FieldControls){"use strict";var OptionSet=function(){function OptionSet(){this.modeManager=new MscrmCommon.DisplayModeManager(this)}OptionSet.prototype.init=function(state){};OptionSet.prototype.changeFocus=function(){this.modeManager.setMode(MscrmCommon.DisplayMode.EDIT,this.getFromReadToEditParamSet())};OptionSet.prototype.renderLabel=function(){var onShortPress=this.context.mode.isControlDisabled?null:this.changeFocus.bind(this),label=this.context.parameters.value.formatted||"---";return this.context.factory.createElement("SPAN",{key:"label",onShortPress:onShortPress},label)};OptionSet.prototype.renderLabelInEditHint=function(){var onShortPress=this.context.mode.isControlDisabled?null:this.changeFocus.bind(this),label=this.context.parameters.value.formatted||"---";label=label+" EditHint";return this.context.factory.createElement("SPAN",{key:"label",onShortPress:onShortPress},label)};OptionSet.prototype.renderOptions=function(){var optionComponents=[],options=this.context.parameters.value.attributes.options;if(this.context.parameters.value.attributes.defaultValue.toString()===OptionSet.UnassingedOptionValue){var emptyOpt=this.context.factory.createElement("OPTION",{value:OptionSet.UnassingedOptionValue,label:"",key:OptionSet.UnassingedOptionValue},"");optionComponents.push(emptyOpt)}for(var i=0;i<options.length;i++){var newOpt=this.context.factory.createElement("OPTION",{value:options[i].Value,label:options[i].Label,key:i.toString()},options[i].Label);optionComponents.push(newOpt)}return optionComponents};OptionSet.prototype.onSelectionChanged=function(event){if(event&&event.target){var target=event.target;this.selectedItem=target.value==OptionSet.UnassingedOptionValue?null:target.value;this.context.utils.notifyOutputChanged()}};OptionSet.prototype.getFromReadToEditParamSet=function(){return null};OptionSet.prototype.render=function(){if(this.context.parameters.ShowLabelWhenUnfocused&&this.context.parameters.ShowLabelWhenUnfocused.raw&&!this.context.mode.hasFocus){this.modeManager.setMode(MscrmCommon.DisplayMode.READ,null);return this.renderLabel()}var interactionMode=this.context.utils.getInteractionMode();if(this.context.utils.isTabPressed()&&(interactionMode==null||interactionMode!=MscrmCommon.DisplayMode.EDIT)){this.modeManager.setMode(MscrmCommon.DisplayMode.EDITHINT,null);return this.renderLabelInEditHint()}this.modeManager.setMode(MscrmCommon.DisplayMode.EDIT,null);var selectChildren=this.renderOptions();if(this.context.parameters.value.raw==null&&this.context.parameters.value.attributes.defaultValue.toString()!=OptionSet.UnassingedOptionValue){this.selectedItem=this.context.parameters.value.attributes.defaultValue;this.context.utils.notifyOutputChanged()}else this.selectedItem=this.context.parameters.value.raw;var renderAsListStyle=this.context.parameters.ShowAsSingleLine&&this.context.parameters.ShowAsSingleLine.raw||this.context.client.userAgent.isAndroid||this.context.client.userAgent.isIos,className="comboBox";if(renderAsListStyle)className+=" comboSingleLine";if(this.context.client.isRtl)className+=" rtl";var dict={key:"comboBox",className:className,tabIndex:"-1",onChange:this.onSelectionChanged.bind(this),defaultValue:this.selectedItem,disabled:this.context.mode.isControlDisabled};if(renderAsListStyle)dict["size"]=selectChildren.length>10?10:selectChildren.length;var select=this.context.factory.createElement("SELECT",dict,selectChildren);return this.context.factory.createElement("VIEW",{className:"input-container"},select)};OptionSet.prototype.getOutputs=function(){return {value:this.selectedItem}};OptionSet.prototype.destroy=function(){};OptionSet.UnassingedOptionValue="-1";return OptionSet}();FieldControls.OptionSet=OptionSet})(FieldControls=MscrmGeneric.FieldControls||(MscrmGeneric.FieldControls={}))})(MscrmGeneric||(MscrmGeneric={}))